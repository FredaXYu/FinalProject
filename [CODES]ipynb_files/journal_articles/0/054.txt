deep neural network dnns widely recognize superior tool cell segmentation28 unlike traditional image process machinelearning approach dnns require train groundtruth dataset cell correspond label train dnns thus limit applicability image representative train dataset early dnn approach base mask rcnn architecture24 whereas recent algorithm stardist cellpose misic base unet architecture12,15,26 pachitariu colleague show cellpose outperform mask rcnn stardist variety cell type celllike object distinguish general solution cell segmentation12 notably representation bacteria study limit misic develop general dnnbased solution bacterial segmentation however author misic provide comparison dnn algorithms15 evaluate performance stateoftheart cell segmentation algorithm diverse collection bacterial cell find motivate design new algorithm omnipose substantially outperform segmentation algorithm test across wide range bacterial cell size morphology optical characteristic make omnipose associate data available researcher anticipate model without retrain apply diverse bacteriological system furthermore follow incorporation additional groundtruth data omnipose could serve platform segment various eukaryotic cell extend anisotropic object broadly numerous image segmentation algorithm develop performance many bacterial cell document broadly fall three category 1 traditional imageprocessing approach example thresholding watershed 2 traditionalmachinelearning hybrid approach 3 dnn approach give goal develop software capacity recognize bacteria universally seek identify strongly perform algorithm development unbiased quantitative comparison cell segmentation algorithm bacterial cell perform thus select one representative category analysis morphometrics 1 supersegger 2 mask rcnn stardist misic cellpose 3. detail review choice method train benchmarking algorithm acquire micrographs assort bacterial specie represent diverse morphology optical characteristic many study bacteria involve mutation treatment cause extreme morphology capture additional diversity include wildtype mutant bacteria grow presence two βlactam antibiotic cephalexin aztreonam a22 target mreb finally base interest microbial community acquire image mixture bacterial specie display distinct morphology optical characteristic total collect 4,833 image constitute approximately 700,900 individual cell derive 14 specie supplementary table 1. next develop streamline approach manual cell annotation apply image method yield 47,000 representative annotate cell serve groundtruth dataset bactphase divide data 27,500cell train set 19,500cell benchmarking set relevant cellular metric area perimeter mean diameter differ substantially group confirm benchmarking set faithfully represent train set extend data fig 1. facilitate direct comparison algorithm first optimize performance data dnn approach algorithm train dataset use developerrecommended parameter morphometrics supersegger automatically optimize use groundtruth data therefore manually identify set optimize performance algorithm dataset method quantitative measure algorithm performance compare average jaccard index ji function intersection union iou threshold fig 1a iou value lie zero one value greater 0.8 mark point mask become indistinguishable grind truth expert human eye extend data fig 2. analysis show dnnbased approach outperform algorithm however substantial difference performance within dnn group observe cellpose stardist outperform mask rcnn misic high iou threshold performance algorithm vary greatly across image bactphase dataset much variability delineate cell type morphology category fig 1bg whereas algorithm exhibit visible segmentation error two three cell category define error cellpose apparent elongate cell fig 1hj comparison reveal cellpose offer superior performance relative segmentation algorithm analyze reason select algorithm development notably even high performance level cellpose 81 prediction benchmarking dataset 0.8 iou limit feasibility highly quantitative study involve subcellular protein localization cellcell interaction cellpose utilize twostep process neural network first transform input image several intermediate output include scalar probability field identify cell pixel next step extend data fig 3aiiii cellpose unique among dnn algorithm addition vector field output flow field define normalize gradient heat distribution median cell pixel coordinate extend data fig 3aiv v second step vector field direct pixel toward global cell center via euler integration thereby segment cell base point pixel coalesce extend data fig 3b contrast algorithm approach reconstruct cell mask size morphologyindependent insofar cell center correctly define understand mechanism behind cellpose segmentation error evaluate performance function cell size bactphase dataset compare cell area number segmentation error calculate number redundant miss mask correspond groundtruth cell mask reveal strong correlation cell size segmentation error top quartile cell account 83 error extend data fig 4a understand source error inspect flow field output many poorly segment cell across variety specie growth condition show elongate cell important morphology often see wildtype mutant bacterial population particularly susceptible oversegmentation extend data fig 4b attribute multiple sink apparent correspond flow field cellpose mask reconstruction algorithm pixel belong cell guide multiple center per cell fragment cell many separate mask hypothesize defect cellpose flow field output consequence two distinct flow field type arise train dataset median pixel coordinate 'center lie within cell 97.8 lie outside cell 2.2. latter cellpose project center point nearest boundary pixel ultimately lead point negative divergence cell periphery chaotically distribute extend data fig 4ce contrary nonprojected center maintain uniform field magnitude along entire boundary adhere global symmetry cell extend data fig 5a similar issue also encounter cell center fall close outside boundary extend data fig 5bd cell center point closer 0.3 time mean cell diameter factor 0.2 offcenter boundary account additional 9.6 train dataset neural network exquisitely sensitive outlier train data therefore suspect small fraction corrupt flow field disproportionate impact performance cellpose seek develop segmentation algorithm operate independently cell center identification algorithm develop base framework cellpose divide five key component file handle neural network architecture train objective function network prediction mask reconstruction make improvement component however major innovation algorithm name omnipose pertain network prediction mask reconstruction unlike cell probability centerseeking flow field upon cellpose construct build omnipose three distinct network output cell boundary probability map distance field flow field define gradient distance field distance field distance transform describe distance point bound region ω closest point boundary 68ω notably widely utilize construct one intermediate output stardist whereas stardist us distance field prediction seed assemble starconvex polygon omnipose implement distance field replacement cell probability output cellpose use distance field several advantage first distance field structure binary probability map offer higher fidelity thresholding seed cell mask second distance field define eikonal equation gradient flow field omnipose unit magnitude throughout bound region calculate lead faster convergence better numerical stability compare alternative solution produce similar field example screen poisson method extend data fig 6a third distance field independent morphology topology mean applicable cell shape size last result flow field point uniformly cell boundary toward local cell center coincide medial axis skeleton define stationary point distance field extend data fig 6b critical feature allow pixel remain spatially cluster euler integration solve problem oversegmentation see cellpose one challenge implement distancefieldbased approach traditional distance field algorithm fast march method fmm sensitive boundary pixelation cause artifact flow field extend deep cell artifact sensitive pixelscale change cell perimeter reason would interfere train process solve problem develop alternative approach base fast iterative method fim produce smooth distance field arbitrary cell shape size fig 2a extend data fig 6 method correspond flow field relatively insensitive boundary feature point remove cell boundary critical property robust generalize prediction cellpose network use distance field additionally require unique solution mask reconstruction whereas pixel centerseeking field converge point standard euler integration distancederived field tend cluster pixel multiple thin fragment along skeleton cause oversegmentation fig 2b solve suppression factor 1 time step euler integration fig 2c reduce movement pixel first step 0 facilitate initial cell separation prevent pixel cluster fragment skeleton formation wider point distribution result suppression factor allow pixel remain connect thereby generate single mask cell conjunction standard automate point cluster algorithm example dbscan benchmark performance omnipose train model bactphaseomni bactphase dataset remarkably across iou threshold range 0.51.0 accuracy omnipose substantially exceed cellpose use correspond model bactphasecp fig 3a difference performance algorithm particularly pronounce within high iou range 0.81.0. bacteria 0.55 μm scale typically image calibrate pixel size 0.1 μm result cell cell label 550 pixel across quantitative measurement scale require pixellevel accuracy correspond iou value 0.8 extend data fig 2. thus omnipose uniquely suit microscopic analysis bacterial cell dissect contribution individual omnipose innovation overall performance algorithm isolate mask reconstruction component omnipose apply cellpose network output augmentation cellpose modestly improve performance across iou threshold fig 3a base attribute remain gain performance omnipose unique network output boundary distance flow improvement cellpose train framework latter include numerous custom loss function use alternative optimizer radam image augmentation method analysis illuminate critical flaw previous dnnbased approach segmentation elongate cell effectively prevent algorithm generalizable application bacteria fig 1. determine whether omnipose overcome limitation evaluate performance function cell area cell area serf convenient proxy cell length dataset compose branch unbranched elongate cell cellpose cell error rate remain 15 across cell omnipose error rate exceed 5 90th percentile cell area reach fig 3b thus omnipose performance independent cell size shape include cell complex extend morphology fig 3c extend data fig 7a show feature omnipose improve bacterial phasecontrast segmentation performance beyond cellpose like dnnbased algorithm omnipose also segment image acquire use different modality compose alternative subject train representative dataset evaluate omnipose image acquire use modality distinct phase contrast curated dataset contain cytosol membrane fluorescence 33,200 bacterial cell bactfluor brief achieve apply label cell fluorescence signal phasecontrast groundtruth image correspond fluorescence channel method expect find enhance performance omnipose bactfluoromni relative cellpose bactfluorcp morphologically diverse cell translate fluorescence image fig 4ad extend data fig 7b next seek investigate potential utility omnipose segmentation nonbacterial subject nematode caenorhabditis elegans widely study model organism overall morphology similar elongate bacteria 1 mm length c. elegans phenotype often analyze timelapse microscopy therefore need segmentation method enable accurate track obtain annotate train omnipose two publicly available lowresolution microscopy datasets compose c. elegans image timelapse frame open worm movement database frame contain field assort live dead c. elegans bbbc010 dataset many image combine worm dataset contain debris heterogenous quality yet 83 mask predict omnipose match exceed 0.8 iou threshold fig 4f low resolution combine c. elegans dataset worm approximate bacteria shape diameter pixel indeed find generalist model train extensive bactphase dataset worm dataset wormbactomni exhibit equivalent higher performance relative specialist worm model wormomni also train omnipose model use custom collection highresolution c. elegans image wormhighres find algorithm successfully segment image despite complex internal structure fig 4h cyto2 large collection image correspond groundtruth annotation submit cellpose user expand upon original cyto dataset develop evaluate cellpose dataset include many noncell image example rock onion well multichannel fluorescence image example cytosol nuclear stain mammalian cell fig 4i extend data fig 8. find omnipose offer modest improvement performance relative cellpose cyto2 dataset fig 4e achieve without compromise segmentation rate ~1 image per second twodimensional 2d image allow characterization cell within constrain environment yet many phenomenon interest study natural threedimensional 3d context modify explicitly 2d component network architecture output mask reconstruction element omnipose enable direct segmentation 3d higher order data contrast solution adopt cellpose cellpose3d approximate 3d field combine 2d flow component predict orthogonal 2d volume slice compare cellpose3d omnipose publicly available arabidopsis thaliana lateral root primordium dataset acquire use confocal microscopy omnipose model train six volume represent 931 cell total plantomni whereas cellpose train 3,070 slice volume plantcp method consistent result 2d omnipose provide accurate segmentation result cellpose particularly among elongate cell dataset fig 5. note absolute score algorithm low attribute part inaccurate groundtruth mask extend data fig 9a b indeed certain instance omniposepredicted mask seem accurate grind truth fig 5b extend data fig 9b notably 3d field reconstruction make cellpose 2d plantcp slice prediction recapitulate much direct 3d field prediction plantomni extend data fig 9c reason local 2d cell slice 'centers cellpose flow field coincident global 3d cell 'skeletons omnipose flow field take together result diverse cell type fluorescence image conclude omnipose maintain multimodal segmentation capability cellpose add ability perform accurate segmentation substantially broader range cellular morphology present within 2d 3d data laboratory recently describe interbacterial type vi secretion systemdelivered toxin produce serratia proteamaculans tre1 ref show toxin act adpribosylating essential cell division factor ftsz however unable robustly evaluate consequence tre1 intoxication target cell morphology due segmentation challenge ask whether omnipose able detect cellular intoxication tre1 end incubate s. proteamaculans wildtype control strain express inactive tre1 tre1 target e. coli cell image mixture 20 h. owe improve segmentation accuracy omnipose bactphase model able include dense field view incorporate ~300,000 cell analysis among cell identify omnipose find small proportion elongate much larger typical bacteria fig 6a b extend data fig 10a cell detect mixture contain active tre1 apparent failure cell septate consistent know ftszinhibitory activity toxin s. proteamaculans strain background employ work express green fluorescent protein correspond fluorescence image allow u unambiguously assign enlarge cell population e. coli fig 6c next subject image cell segmentation stardist cellpose misic three topperforming algorithm initial survey algorithm fail identify population cell high precision fig 6d e close inspection reveal three distinct mode failure fig 6e extend data fig 10a b case stardist elongate nonstarconvex cell split multiple starconvex subset span entire cell cellpose detect entire elongate cell fragment multitude smaller mask conversely misic detect cell fail properly separate thereby exaggerate area measurement many case include e. coli cell control experiment data illustrate enhance cell segmentation performance omnipose facilitate unique insight microbiological