although term 'graph neural network may better know 'graph network function graph network employ need neural networks31 fact pegn approach contain neural network core propose pegn formulate discretization pf equation machine learn problem graph inspire recent findings38 show deep graph neural network view discretization underlie diffusive partial differential equation pegn offer perspective efficiently solve pf problem metal use powder bed fusion pbf 316l stainless steel test bed demonstrate effectiveness propose pegn furthermore compare pegn classic dns approach finite difference method several key aspect temperature field melt pool development grain evolution demonstrate propose approach speed pf method order magnitude preserve significantly high accuracy section structure follow first introduce key ingredient pegn section hysicsembedded graph network section singlelayer singletrack simulation present detail comparison dns pegn use singlelayer singletrack example benchmark comparison focus qualitative quantitative evaluation temperature field melt pool development grain evolution finally section multilayer multitrack simulation present several multilayer multitrack simulation example demonstrate scalability pegn overview propose method present fig 1. view microstructure evolution problem machine learn task define graph network process dynamic microstructure evolution treat analogous messagepassing procedure graph network typical machine learn task loss function define learnable parameter train minimize loss value problem physicsbased free energy fθ define dynamic feature θ solve minimize free energy show fig 1 take gradient free energy obtain set govern differential equation l precoefficients discuss section pegn approach note view gradient flow problem time integration scheme like explicit euler give recover predominant gradient descent algorithm machine learn fθ may depend θ complicate way see detail equation 11 14 use backpropagation i.e. reversemode automatic differentiation automate computation derivative context train neural network backpropagation refer find derivative loss function respect weight work mean find derivative energy function fθ respect θ. compare gridbased spatial discretization method use dns pegn essentially perform spatial discretization graph respect initial grain structure phasefield physic map framework graph network consider individual grain adjacent grain interaction leave detail description pegn method section pegn approach first example consider singlelayer singletrack pbf process show upper leave part fig 1a simulation domain 1000 × 400 × 100 μm consist equiaxed grain different orientation color ipf inverse pole figure color respect build direction zaxis memory efficiency 20 randomly generate orientation use grain randomly assign one orientation initial step random orientation show supplementary fig 2. total number 40,000 grain generate use open source software package neper polycrystal generation laser beam scan start position 200 200 100 μm end position 800 200 100 μm use 1200 μs uniform scan speed 0.5 66 s. scan simulate additional 1800 μs time period cool sample material parameter share dns pegn find supplementary table 1. besides propose pegnbased simulation also implement classic finite difference method direct numerical simulation dns approach serve grind truth implementation generally follow previous work follow section compare simulation result dns pegn three aspect temperature field melt pool morphology grain evolution comparison pegn show consistent outcome dns fullfield tempospatial temperature evolution solve fly variable like grain orientation treat laser heat source use pbf process timedependent heat flux boundary condition top surface domain convection radiation boundary condition consider ambient temperature figure 2a b show temperature profile 1200 μs time laser finish scan note pegn inherently us graph network representation temperature field fig 2b show reconstruct profile use polyhedron mesh clearer visualization quantitatively select center point position 500 200 100 μm top surface show temperature history fig 2c see temperature history dns pegn match almost exactly center point temperature field oneway couple liquidsolid fraction variable grain orientation field make truncation 2000 k couple avoid spuriously high temperature value another example fix time frame 1200 μs check temperature profile along center line top surface show result fig 2d observe dns pegn produce similar temperature profile melt pool dynamic important subject study since reflect interaction pbf process parameter material solidification solidliquid fraction field ζ part dns pegn solution use represent melt pool development variable ζ continuously vary 0 1 indicate transition liquid state solid state melt pool identify region ζ 0.5. select five consecutive time frame show melt pool morphology fig 3. melt pool march towards positive xaxis direction transform long shallow shape shrink laser turn 1200 μs show pegn capable produce qualitatively similar morphology compare dns quantitative comparison evaluate length width height volume melt pool quantity evolve time show fig 4. general observe good agreement dns pegn result melt pool height discrepancy around 0.01 mm roughly scale one grain central task work predict microstructure evolution pbf process variable solve grain orientation η use onehot encode indicate orientation certain grain take dns approach implement framework classic phasefield method contrast propose pegn method solve phasefield problem define graph select five consecutive time frame show grain evolution fig 5 ipf color respect zaxis indicate grain orientation fig 5 melt pool region remove solid part show phenomenon epitaxial grain growth reproduce grain continuously grow previously solidify region newly solidify area near melt pool boundary also observe grain coarsen heataffected zone occur smaller grain merge larger grain perform quantitative comparison grain size grain morphology dns pegn first inspect total number grain solidify area scan track show result fig 6a observe curve dns pegn first peak around 1400 μs decrease due grain coarsen finally approach stable value cool process fig 6b trend average grain volume show increase time dns pegn study grain morphology compute aspect ratio φ 2ab c define ratio longer axis shorter ax ellipsoid equivalent grain shape definition aspect ratio make clear diagram fig 6c histogram plot aspect ratio final time step dns pegn show observe aspect ratio dns pegn follow similar distribution distribution exhibit longtailed feature demonstrate existence long columnar grain structure median aspect ratio dns 1.71 pegn 1.62 show columnar grain predominant equiaxed grain observation also make fig 5 slant inward columnar grain eventually lead anisotropic mechanical property asbuilt component nevertheless result show pegn capable generate grain size morphology comparable dns study quantitative comparison result fig 6 affect several key factor include number initial grain grain orientation initial size distribution grain well laser parameter perform additional numerical experiment report result discussion supplementary note 5. case pegn agree well dns since pegn model grain growth combine adjacent grain orientation worthwhile track growth kinetics give individual grain discrepancy pegn dns understand better fig 7 first filter group grain orientation focus growth single grain dns pegn show morphology two select grain grow history 1500 μs 3000 μs two select grain dns pegn grow irregular shape morphology difference dns pegn cause partly different underlie spatial discretization scheme structure grid dns graph pegn quantitatively compute evolve history volume surface area two grain show comparison bottom part fig 7 whose trend similar previous section make detail comparison dns pegn term temperature field melt pool development grain evolution show propose pegn able produce consistent outcome dns result key advantage pegn however lie computationally efficient dns singlelayer singletrack example dns domain discretized 3,969,984 finite difference cell cell connect 11,793,748 edge cell store total number 22 degree freedom 1 temperature 1 solidliquid fraction 20 grain orientation number explicit time integration step 15,000. constrast pegn us graph network discretization total number node 40,000 node represent single grain number edge 289,986. node store total number 22 degree freedom number time integration step 15,000. wall time measurement dns 1298 second 25 second pegn perform nvidia quadro rtx 8000 gpu 48 gb graphic memory propose pegn therefore 52× faster classic pf dns method perform wall time measurement disable io process focus simulation fact dns require much time io process give pegn extra advantage computational save note number total degree freedom dns around 100× pegn acceleration around 50× acceleration ratio due another limit factor number edge dns 40× pegn study effect initial number grain grain orientation computational performance perform additional numerical experiment analyze result supplementary note 4. term space pegn consume le memory dns promise larger scale simulation require large amount memory completeness program also run cpu 2.4 ghz 8core intel core i9 32 gb memory wall time dns 29 hour 2018 second pegn simulation cpu pegn also around 52 time faster dns result consistent find gpu scalability pegn computational time space allow simulation larger size problem practically difficult dns method employ pegn perform multilayer multitrack simulation pbf process figure 8a show layer computational domain size 2 × 2 × 1 mm layer graph contain 200,000 node entire domain 4,000,000 node 22 degree freedom attach node since critical physical process like grain evolution happen top layer layer fully cool solid structure strategy limit simulation domain current top two layer computational resource save description strategy illustrate fig 8a iteration take current top layer last iteration initial condition green layer combine newly add layer blue layer perform simulation use domain consist two layer procedure repeat 20 layer entire simulation take around 6.5 hour gpu scan path show fig 8b resemble acronym 'nu keep total number 20 layer thickness 0.05 mm fig 8c show grain structure entire simulate domain grain structure asbuilt sample show fig 8d one representative yz plane cross sectional view show fig 8e simulation able take account remelting resolidifying grain columnar grain across several layer form see fig 8e due repeat directional scan multiple layer number grain show angle inclination around 60 align inclination angle melt pool scan process pattern also find previous work simulation experiment fig 8d observe clearly layer surface asbuilt sample explain due melt pool shape along scan path note case build 'nu pattern 3d part layer vacant additive manufacture process assume laserbased powder bed fusion black region fig 8b also contain randomly generate grain represent unmelted powder case black region vacant grain structure near boundary affect surround grain anticipate grain structure respect initial orientation better laser scan strategy critical effect development microstructure texture pbf process pegn study effect scan strategy consider 10layer build process computational domain size 2 × 2 × 0.5 mm show fig 9. consider two different scan strategy compare generate grain structure fig 9a first scan strategy unidirectional scan track within layer pattern repeat layer fig 9b second scan strategy bidirectional pattern within layer pattern successively rotate 90 across layer figure 9c show entire computational domain final step due different scan strategy top surface two part show distinct grain structure pattern seem orthogonal xz plane cross sectional view plot fig 9e f. first scan strategy observe characteristic vshaped grain vshaped grain stack vertically vertical boundary repeat stack align laser scan path second scan strategy generate grain arrange arbitrarily show organize pattern like first scan strategy observation indicate unidirectional scan strategy lead grain structure high anisotropy whereas alternate scan pattern layer introduce certain randomness grain structure may alleviate strong anisotropy furthermore hide region never melt entire pbf process show result fig 9g h. addition distinct boundarysurface feature two scan strategy also observe certain region due lack fusion show grain volume distribution fig 9i mean grain size 49162 μm 56332 μm two scan strategy total number generate grain 22,438 19,593 respectively therefore second scan strategy generate 12.6 fewer grain increase 14.6 average grain