figure 1a show architecture propose smaonn consist input layer multiple hide layer monitor signal output layer layer optical signal process optical linear transformation alloptical nonlinear activation build block different traditional architecture nonlinear activation block produce electrical signal monitor state neuron optical linear transformation implement use reconfigurable sibased machzehnder interferometer mzi mesh equivalent photonic field programmable gate array show fig 1b prove arbitrary optical linear operation carry series optical beam splitter phase shifter attenuator i.e. tunable mzis fig 1c show voltage signal digitaltoanalog converter dacs load two thermaltuning electrode sibased mzi state mzi control linear operation entire network form weight neuron store update voltage information note complete neuron contain linear weight part nonlinear part thermooptic phase shifterbased linear weight mesh indispensable build complete neuron optical linear operation optical signal undergo gesi alloptical nonlinear unit aonus perform nonlinear process activation function show fig 1d meanwhile aonu provide electrical monitor signal indicate result weight addition nonlinear operation monitor input output optical power aonus unlike conventional lightsplittinganddetection solution photoelectric monitor occur concomitantly optical nonlinear activation structure fig 1e show fig 1f monitor signal draw electrode convert digital domain analogtodigital converter adcs nonintrusive manner detect current node state realtime without change network operate point thus enable high performance stability smaonn key component smaonn gesi aonu enable alloptical nonlinear activation nonintrusive monitor figure 2a show structure schematic similar gesi waveguide pd apply photoelectric detection fig 2b conventional pd electrode length ge film export photogenerated carrier part absorber typically output optical power le concern different electrode herein omit light incident engineer carrier dynamic detail device geometry optical field information find supplementary note 1. electrodeless region small electric field carrier transit time carrier lifetime carrier accumulate enable fca ge film produce strong alloptical nonlinear response region electrode strong electric field carrier transit time carrier lifetime carrier rapidly absorb electrode fca effect occur fortunately collect carrier use optical monitor specific mechanism activation function conform propose partial electrode structure give supplementary note 2 3. solve nonlinear schr02dinger equation nlse carrier rate equation see method activation function obtain represent στ204ωs 0 relationship degenerate linear absorption p p input output optical power respectively α σ τ l intrinsic absorption coefficient absorption crosssection fca carrier lifetime length ge film well incident area l length electrode 04 ω represent reduce planck constant optical frequency respectively meanwhile concomitant electrical monitor signal occur thank intrinsic absorption photoelectric conversion fca effect transfer momentum electron provide photocurrent nonlinear relationship output current input optical power express r p output current responsivity lowpower level input optical power saturation current respectively k parameter use change shape curve note optical monitor nonintrusive bond wire place ~3 μm sige region little influence optical signal main reason call nonintrusive addition propose device consume portion optical power achieve optical nonlinearity result photocurrent use realize monitor time say optical power use achieve optical nonlinearity inherently consume additional optical power need achieve monitor another important reason call nonintrusive length ratio electrode ge film significantly affect opticaltooptical opticaltoelectrical response longer electrode improve carrier collection efficiency thereby increase output photocurrent however reduce carrier concentration weaken fca effect relationship carrier collection efficiency photocurrent refer supplementary note 4. figure 2c show carrier concentration collection efficiency η versus length ratio pink area 0.20.4 represent typea achieve 90 maximum value within range good optical nonlinearity high optical monitor responsivity obtain simultaneously range consider optimal ratio orange area 1 show conventional pd represent typeb low optical nonlinearity figure 2d show falsecolor image fabricate aonu 4.3 × 8 μm ge thin film epitaxially grow si waveguide 3 μmlength electrode coat optical exportation ge adopt scheme typea correspond 0.375. see method fabrication detail experimentally verify optical electrical response propose aonu compare reference conventional pd pp relation show fig 2e typea output power linear low input gradually flatten power increase show obvious pp nonlinearity however curve typeb linearly tangent typea input difference two curve contribute fca threshold nonlinear activation 1.1 mw low threshold requirement beneficial low power consumption drive nonlinearity unit next level activation function fit eq 1 solid line show fig 2e hand measure output photocurrents show fig 2f although linearity slightly reduce photocurrent still increase monotonously input optical power input optical power uniquely determine monitor output current combine pp relation output optical power also determine photodetection metric include responsivity bandwidth dark current refer supplementary note 6. bandwidth influence dope aonu detail analysis give supplementary note 7. prove state neuron obtain monitor signal performance entire neural network characterize prepare scalable threelayer fully connect feedforward neural network use mzi mesh propose aonus show fig 3a although threelayer network build one chip fabrication process split three chip connect use optical fiber array easy comparison arbitrary combination importantly layer network construct use optical fiber array connect multiple chip three layer sufficient demonstrate follow machine learn task high accuracy figure 3b show one layer package smaonns consist four neuron 16 mzis four nonlinear unit mzi mesh nonlinear unit present fig 3c respectively basic operation neural network train inference compare inference train consume compute power neural network however complete quickly automatically use selfmonitoring electrical signal combine special process chip optoelectronic integration train set machine learn task consist series vector input output encode optical power show fig 4a input optical signal process photonic chip obtain real optical output different conventional train method real output read monitor signal rather external pd loss function crossentropy define evaluate distance real output trainingset predict output difference eliminate iteration feedback algorithm backpropagation special process chip smaonn train completely detail situ train implementation refer supplementary note 8. experimentally simplify object classification semantic segmentation task perform show fig 4b utilize twovalued optical intensity encode label four input target example '0110 input '0100 output represent 'target 2 optical input port port 2 3 configure pas via variable optical attenuator voas neural network successfully train port 2 expect optical output real application target represent different grayscale image figure 4c show relationship loss function iteration output histogram initial state intermediate state 20 iteration final state show inset initial state output mode chaotic since weight mzi network give randomly reconstruction weight recognition mode become clearer fully configure output probability mode correct port exceed 97. similarly train semantic segmentation present 4 × 4pixel image show fig 4d gray level l 't'type region greater others train gray level 1 0 contrastive identify l 't image since input smaonn column vector direction sum normalize output power direction remain unity fig 3e show number iteration exceed 15 epoch output port near expectation 50 two input port 100 one input port two experiment error analysis refer method successful train two different task demonstrate general configuration task powerful learn ability smaonn thank electrical monitor signal train result extremely high expect accuracy largescale train task fully automate help electronics use digital compute example actually demonstrate photonic neuromorphic compute architecture analog nature use analog compute well mzi weight network directly handle multiplication complexvalued data optical nonlinear response also continuousvalued inputoutput function difference analog compute digital compute form input output data set current digital input 0 1 replace continuoustime optical intensity analog compute perform go forward introduce obtain nonlinear optical response nonlinear activation function threelayer deep feedforward neural network mnist handwrite recognition test largescale data process capability mnist data set consist 60,000 784pixel image therein 50,000 10,000 image use train test respectively image contain handwritten digit 0 9 show fig 5a deep feedforward neural network consist two hide layer contain 200 neuron output layer contain 10 neuron input 784 × 1 vector output 10 × 1 vector output layer adopt softmax activation function convert output result probability propose gesi aonu extract activation function hide layer activation function normalize input output show fig 5b simulation utilize conjugate gradient backpropagation algorithm iterate 100 time loss function crossentropy accuracy 97.3 correspond confusion matrix show fig 5c respectively column matrix represent instance predict label row represent instance true label diagonal element represent probability correctly predict result show nonlinear unit high performance representative machine learn \<SEP>4