probe cortical hippocampal contribution generalization develop behavioral paradigm mouse encounter series problem abstract structure probabilistic reversal learn different physical instantiation hence different sensorimotor correlate record single unit mpfc hippocampus across multiple problem record session examine neuronal representation individual element trial crosstrial learn control animal choice mpfc dca1 representation trial event low dimensional small set temporal pattern activity correspond tune particular trial event explain large fraction variance region however differ respect representation generalize across problem mpfc neuron tend represent event across problem irrespective sensorimotor particular current problem contrast although event represent hippocampus problem specific neuron represent give event differ problem hippocampus prefrontal cortex pfc also contain representation animal current policy integrate event multiple trial policy representation abstract pfc tie sensorimotor specific hippocampus subject serially perform set reversal learn problem share structure different physical layout problem every trial start 'initiation nosepoke port light poke port illuminate two 'choice port subject choose probabilistic reward fig 1a subject consistently 75 trial choose high reward probability port reward contingency reverse fig 1b subject complete ten reversal give port layout term 'problem move onto new problem initiation choice port different physical location fig 1c problem therefore share trial structure initiate choose common abstract rule one port high one low reward probability reversal require different motor action due different port location phase experiment problem switch occur session subject complete ten different problem first ask whether subjects03 performance improve across problem consistent generalize problem structure one port good time reversal fig 1b mouse take fewer trial reach 75 correct threshold trigger reversal within problem f 3.52 p 0.001 extend data fig 1a crucially also across problem f 3.91 p 0.001 fig 1e consistent generalization improvement across problem track good port might reflect increase ability integrate history outcome choice across trial ass fit logistic regression model predict choice use recent history choice outcome choice × outcome interaction across problem influence recent f 5.08 p 0.001 fig 1j l earlier f 5.46 p 0.001 fig 1j l choice × outcome interaction increase subject choice also increasingly strongly influence previous choice f 11.77 p 0.001 fig 1i k suggest decrease spontaneous exploration also ask whether subject generalize trial structure initiate choose fig 1a across problem assess often make nosepokes inconsistent sequence poke alternative choice port make choice instead return initiation mouse make fewer outofsequences poke across reversal within problem f 17.82 p 0.001 extend data fig 1b notably also across problem f 18.29 p 0.001 fig 1g improvement drive animal poor performance first problem continue throughout train f 9.36 p 0.001. ass whether drive simply learn follow port illumination examine behavior 'forced choice trial one choice port illuminate inactive animal follow light equally likely poke high reward probability choice port choice port illuminate demonstrate behavior influence belief reward availability port illumination extend data fig 2i j although remain possible use port illumination acquire new problem observe improvement across problem consistent metalearning 'learning learn line early problem mouse learn new poke sequence necessary execute trial gradually many reversal suggest instrumental learn however end train acquire new poke sequence single reversal suggest 'learned learn sequence 2.81 p 0.023 fig 1h similarly animal adapt reversal faster end train compare begin train 5.04 p 0.001 fig 1f therefore also 'learned learn reward data demonstrate generalization provide mechanism possible mechanism task abstraction whereby brain us neuronal representation different physical situation play task role investigate whether representation exist next examine cellular response mpfc hippocampus record single unit dorsal ca1 345 neuron n 3 mouse 91162 neuron per mouse mpfc 556 neuron n 4 mouse 117175 neuron per mouse supplementary fig 1 fig 2 separate animal use electrophysiology record modify behavioral task change one problem next occur within session problem transition trigger subject complete four reversal current problem maximum three problem one session subject adapt well record session perform least four reversal three problem allow u track activity individual unit across problem fig 2c crossproblem learn reach asymptote start record record session mouse longer show improvement across problem extend data fig 2 difference behavioral performance ca1 pfc animal extend data fig 2c f record session 716 session per mouse 341650 trial per session use ten different port layout simplify analysis reflection three basic layout type fig 2b occur every session randomize order first layout type initiation port i1 top bottom port choice port far leave far right port one choice port remain location three layout use session refer choice act control physical location allow u ass change context different problem affect representation choose physical port choice port b choice initiation port move physical location problem second layout type initiation port i2 b choice port b2 location use layout type 1. third layout type initiation port initiation port layout type 1 i3 i1 b choice port initiation port layout type 2 b3 i2 hence every record session example 1 port play role across problem 2 different port play role across problem 3 port play different role across problem animal transfer knowledge trial structure across problem reason neuron might exhibit 'problemgeneral representation abstract stage trial initiate choose outcome divorce sensorimotor specific problem inspection cell common pfc fig 2d 3a extend data fig 3a although problemgeneral tune observe ca1 activity give trial event example initiation typically vary across problem ca1 pfc fig 2e 3b extend data fig 3b 4. ca1 neuron fire physical port across problem even though role task change ca1 neuron 'remapped problem change tune respect physical location trial event singleunit example suggest problemgeneral representation may prominent pfc tune physical location complete remapping problem may common ca1 ass whether singleunit observation hold population level seek characterize neural activity region represent trial event representation generalize across problem first assess influence different trial variable region use linear regression predict spike activity neuron timepoint across trial function choice outcome outcome × choice interaction trial fig 4a task selfpaced align activity across trial warp time period initiation choice match median interval detail see 'time warp method supplementary fig 2. quantify strongly variable affect population activity population coefficient partial determination cpd fraction variance uniquely explain regressor every timepoint across trial fig 4b analysis run separately problem session result average across problem session region represent current choice outcome choice × outcome interaction regional specificity strongly variable represent choice v b representation pronounce ca1 pfc peak variance explain ca1 8.4 pfc 4.8 p 0.001 whereas outcome reward v reward cod stronger pfc peak variance explain ca1 7.1 pfc 12.9 p 0.001. furthermore choice × outcome interaction explain variance ca1 pfc peak variance explain ca1 3.7 pfc 2.4 p 0.001. although highlight difference population cod region approach ass relative contribution abstract representation generalize across problem versus feature specific problem physical port location require compare activity across timepoints trial across problem use representational similarity analysis rsa extract fire rate around initiation choice port entry ±20 m around port entry type categorize window problem come whether initiation choice choice port entry whether choice b whether reward yield total 15 category fig 4c session compute average activity vector category quantify similarity category correlation correspond activity vector show rsa matrix 'choice time analysis fig 4c leave panel 'outcome time analysis fig 4c right panel window choice event move 250 m port entry hold time window around trial initiation constant quantify factor influence representation similarity create representational similarity design matrix rdms encapsulate predict pattern similarity assumption activity influence single feature behavior fig 4d example population activity represent physical port animal correlation matrix would look like fig 4d port include rdms set problemgeneral feature trial stage 'initiation v choice choice v b trial outcome 'outcome conjunction choice 'outcome v b ass whether change context provide different problem modify representation choose physical port trial stage include 'problemspecific choice rdm represent similarity choice always location within problem ass influence feature neural activity model experimentally observe pattern representational similarity fig 4c linear combination rdms fig 4d quantify influence correspond weight linear fit rsa matrix change choice time outcome time fig 4c characterize time evaluation use series linear fit move time window around choice port entry step port entry reward delivery hold time window around initiation port constant generate time series influence rdm activity show fig 4e consistent singleunit observation pfc ca1 represent problemspecific problemgeneral feature extent however mark regional specificity strongly different feature encode fig 4e pfc stronger abstract sensorimotorinvariant representation trial stage initiation v choice trial outcome p 0.001. contrast ca1 stronger representation physical port subject poke whether v b choice p 0.001. additionally ca1 pfc show problemspecific representation choice p 0.001. strike choice physical port mean identical across problem indicate change problem context alone induce 'remapping ca1 pfc finally regional difference representation trial outcome pfc outcome representation general neuron respond reward reward omission across port problem p 0.001. ca1 also maintain outcome representation likely conjunctive pfc different neuron would respond reward b choice p 0.001. representational difference region survive animal random effect test see 'statistical significance section extend data fig 5 individual animal plot extend data fig 6ac ensure drive finegrained selectivity physical movement rerun analysis residual fire rate regress influence twodimensional 2d nose position velocity acceleration detail see 'additional control physical movement section interregion difference except stronger representation v b choice ca1 survive control extend data fig 7ce consistent singlecell example describe fig 3a b extend data fig 3. also assess whether problem specificity ca1 might drive slow drift time find representation change abruptly transition problem extend data fig 8. use crossproblem decode analysis characterize difference representation region train linear model decode position trial initiation ab choicerewardnoreward use data one problem test decode performance different problem fig 4f g b initiation port move sometimes interchange problem pattern decode error informative whether activity primarily represent physical port abstract trial stage initiation v choice pfc make error predominantly state could occur sequential position trial rather b choice outcome contrast ca1 predominantly decode physical port train data together population result confirm pfc predominantly generalize representation representation embed sequential property trial ca1 encode problem specific port identity strongly explore structure population activity generalize problem assess accurately lowdimensional activity pattern one problem could explain activity another use singular value decomposition svd decompose activity problem set cellular temporal mode cellular mode correspond set neuron whose activity covaries time hence think cell assembly cellular mode specify vector weight cell indicate strongly cell participate mode cellular temporal mode come pair cellular mode correspond temporal mode vector weight across timepoints indicate activity cellular mode vary time evaluate cellular temporal mode give problem first regress general movementrelated feature onto fire rate detail see extend data fig 7 'additional control physical movement section remove effect velocity acceleration 2d nose position compute average residual fire rate timepoint across trial four type trial reward choice nonrewarded reward b nonrewarded b nonrewarded trial include correct trial incorrect trial cell concatenate four time series create single time series contain average activity cell across timepoint four trial type temporal mode span set timepoints hence capture variation across timeintrial trialtype stack singlecell activity time series neuron create activity matrix row contain activity one neuron fig 5a use svd decompose activity matrix cellular temporal mode u v link diagonal weight matrix σ cellular mode column u temporal mode row v. mode unit vector contribution pair total data variance determine correspond element diagonal matrix σ. mode sort order explain variance first cellular temporal mode pair explain variance first cellular temporal mode pfc activity three different problem show fig 5b c high throughout intertrial interval iti trial peak choice time strongly suppress reward similar cell 5 fig 2d reason 1 event represent across problem example initiation ab choice outcome temporal mode would exchangeable problem matter whether representation find cell 2 cell assembly use across problem cellular mode would exchangeable across problem matter whether cell assembly play role problem 3 cell assembly perform role problem pair cellular temporal mode would exchangeable across problem see whether representation exist problem first ask well temporal mode one problem could use explain activity problem set temporal mode v orthonormal basis data rank le perfectly explain use temporal mode however population activity problem low dimensional small number mode explain great majority variance mode explain lot variance one problem explain lot variance problem structure capture mode prominent problem question therefore quickly variance explain problem 203s data use mode problem 1 order accord variance explain problem 1. ass project data matrix problem 2 onto temporal mode v problem 1 give matrix whose element indicate strongly temporal mode contribute problem 2 activity neuron variance explain temporal mode give square element sum neuron express percentage total variance plot cumulative variance explain function number d03s temporal mode order mode accord variance explain fig 5d control drift neuronal representation across time compute data matrix separately first second half problem compare amount variance explain use mode first half one problem model activity second half problem variance explain use mode second half one problem model activity first half next problem pfc ca1 cumulative variance explain function number temporal mode use depend whether two datasets problem solid different problem dash fig 5d h p 0.05. indicate temporal pattern activity therefore trial event represent differ across problem either brain area however analysis use temporal mode say nothing whether different neuron represent give event across problem fact even explain activity one brain region use temporal mode another region mouse fig 5e pattern different use cellular mode assembly coactivating neuron one problem explain activity another quantify variance explain problem 2 use cellular mode problem 1 project problem 2 data matrix onto problem 1 cellular mode u give matrix whose element indicate strongly cellular mode contribute problem 2 activity timepoint total variance explain temporal mode give square element sum timepoints pfc ca1 cellular mode u explain lot variance one problem explain variance half problem adjacent problem fig 5f difference solid dash line however withinproblem versus crossproblem difference larger ca1 pfc fig 5i p 0.05. indicate pfc neuron whose activity covaried one problem likely also covary another problem compare ca1 neuron analysis consider cellular mode indicate whether give cell assembly carry information across problem ass well cellular temporal activity pattern problem 1 explain activity problem 2 project dataset onto cellular temporal mode pair problem 1 v. cell assembly perform role two different problem temporal cellular mode align σ high weight diagonal therefore plot cumulative square weight diagonal element σ within problem fig 5g pfc ca1 cellular temporal mode align better different datasets problem solid line different problem dash line however difference substantially larger ca1 pfc fig 5j p 0.05. result also hold true use time window initiation choice extend data fig 9. data show although temporal structure activity region generalize perfectly across problem brain region subject consequence set trial event represent cell assembly use represent generalize strongly pfc ca1 far focus neuronal representation individual trial event generalize across problem maximize reward subject must also track option best integrate history choice outcome across trial useful generalization policy representation also divorce current sensorimotor experience specific problem estimate subject belief option best use logistic regression predict current choice function choice outcome history fig 6a give trialbytrial estimate probability animal would choose versus b animal 's policy use policy predictor linear regression predict neural activity run separately problem result average across problem session fig 6b policy explain variance capture withintrial regressors choice reward choice × reward interaction specifically subject policy interact current choiceexplained variance p 0.001 start around time trial initiation would particularly useful guide decision next ask whether policy representation generalize across problem policy may generalize differentially b choice b port vary problem therefore analyze b choice trial separately run set linear regression predict neural activity one problem single timepoint trial use policy trial outcome regressors policy beta weight regression correspond pattern neural activity represent policy one problem one timepoint therefore quantify extent policy representation generalize problem correlation coefficient policy beta weight compute average acrossproblem correlation weight every pair timepoints fig 6c diagonal element matrix show average correlation across problem timepoint problem correlation larger pfc ca1 b choice p 0.05 permutation test fig 6d show average policy representation generalize across problem better pfc ca1 one possible explanation pfc simply represent action value problemgeneral way interest possibility current policy shape representation trial stage differently ca1 representation tie sensorimotor specific current problem test examine time slice correlation matrix initiation choice outcome time fig 6e pfc three correlation profile b trial peak correct timepoint equivalent diagonal element matrix policy representation generalize across problem specific part trial initiate choose outcome similar pattern present ca1 choice physical port across problem ca1 correlation significantly zero b choice indeed whereas pfc policy correlation greater ca1 correlation representation p 0.05 b choice ca1 correlation show greater difference b trial outcome time fig 6e p 0.05. overall therefore pfc ca1 maintain representation subject 's current policy simple value representation differ depend trial stage representation abstract across problem pfc tie sensorimotor specific ca1 portion problem specificity ca1 account port \<SEP>3